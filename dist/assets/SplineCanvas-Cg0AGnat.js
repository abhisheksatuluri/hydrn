const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/three-vendor-DP-0WGkj.js","assets/react-vendor-D70t8mH6.js","assets/GLTFLoader-B5cqw9HA.js","assets/DRACOLoader-DtzSuKKZ.js"])))=>i.map(i=>d[i]);
import{D as Q,H as V,F as $,a as N,L as Z,b as Y,j,G as ee,_ as z}from"./three-vendor-DP-0WGkj.js";import{r as w}from"./react-vendor-D70t8mH6.js";const O={hero:"/spline_scenes/hero.glb",bubbles:"/spline_scenes/bubbles.glb",route:"/spline_scenes/route.glb",medal:"/spline_scenes/medal.glb",rave:"/spline_scenes/rave_lights.glb",shoe_morph:"/spline_scenes/shoe_morph.glb",about:"/spline_scenes/route.glb",footer:"/spline_scenes/bubbles.glb"},q=new Map,X=d=>{if(!O[d]||q.has(d))return;console.log(`[SplineLoader] Preloading scene: ${d}`);const g=O[d],p=document.createElement("link");p.rel="preload",p.as="fetch",p.crossOrigin="anonymous",p.href=g,document.head.appendChild(p),q.set(d,{status:"preloading",url:g})},te=async d=>O[d]?(console.log(`[SplineLoader] Loading scene: ${d}`),O[d]):(console.warn(`[SplineLoader] Scene ID "${d}" not found in map.`),null);class J extends Q{constructor(g){super(g),this.type=V}parse(g){const c=function(e,r){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(r||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(r||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(r||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(r||""))}},R=`
`,v=function(e,r,t){r=r||1024;let s=e.pos,l=-1,n=0,m="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(s,s+128)));for(;0>(l=a.indexOf(R))&&n<r&&s<e.byteLength;)m+=a,n+=a.length,s+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(s,s+128)));return-1<l?(e.pos+=n+l+1,m+a.slice(0,l)):!1},C=function(e){const r=/^#\?(\S+)/,t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,n={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let m,a;for((e.pos>=e.byteLength||!(m=v(e)))&&c(1,"no header found"),(a=m.match(r))||c(3,"bad initial token"),n.valid|=1,n.programtype=a[1],n.string+=m+`
`;m=v(e),m!==!1;){if(n.string+=m+`
`,m.charAt(0)==="#"){n.comments+=m+`
`;continue}if((a=m.match(t))&&(n.gamma=parseFloat(a[1])),(a=m.match(o))&&(n.exposure=parseFloat(a[1])),(a=m.match(s))&&(n.valid|=2,n.format=a[1]),(a=m.match(l))&&(n.valid|=4,n.height=parseInt(a[1],10),n.width=parseInt(a[2],10)),n.valid&2&&n.valid&4)break}return n.valid&2||c(3,"missing format specifier"),n.valid&4||c(3,"missing image size specifier"),n},u=function(e,r,t){const o=r;if(o<8||o>32767||e[0]!==2||e[1]!==2||e[2]&128)return new Uint8Array(e);o!==(e[2]<<8|e[3])&&c(3,"wrong scanline width");const s=new Uint8Array(4*r*t);s.length||c(4,"unable to allocate buffer space");let l=0,n=0;const m=4*o,a=new Uint8Array(4),G=new Uint8Array(m);let U=t;for(;U>0&&n<e.byteLength;){n+4>e.byteLength&&c(1),a[0]=e[n++],a[1]=e[n++],a[2]=e[n++],a[3]=e[n++],(a[0]!=2||a[1]!=2||(a[2]<<8|a[3])!=o)&&c(3,"bad rgbe scanline format");let k=0,b;for(;k<m&&n<e.byteLength;){b=e[n++];const L=b>128;if(L&&(b-=128),(b===0||k+b>m)&&c(3,"bad scanline data"),L){const S=e[n++];for(let W=0;W<b;W++)G[k++]=S}else G.set(e.subarray(n,n+b),k),k+=b,n+=b}const K=o;for(let L=0;L<K;L++){let S=0;s[l]=G[L+S],S+=o,s[l+1]=G[L+S],S+=o,s[l+2]=G[L+S],S+=o,s[l+3]=G[L+S],l+=4}U--}return s},h=function(e,r,t,o){const s=e[r+3],l=Math.pow(2,s-128)/255;t[o+0]=e[r+0]*l,t[o+1]=e[r+1]*l,t[o+2]=e[r+2]*l,t[o+3]=1},A=function(e,r,t,o){const s=e[r+3],l=Math.pow(2,s-128)/255;t[o+0]=N.toHalfFloat(Math.min(e[r+0]*l,65504)),t[o+1]=N.toHalfFloat(Math.min(e[r+1]*l,65504)),t[o+2]=N.toHalfFloat(Math.min(e[r+2]*l,65504)),t[o+3]=N.toHalfFloat(1)},x=new Uint8Array(g);x.pos=0;const D=C(x),H=D.width,I=D.height,P=u(x.subarray(x.pos),H,I);let T,F,y;switch(this.type){case $:y=P.length/4;const e=new Float32Array(y*4);for(let t=0;t<y;t++)h(P,t*4,e,t*4);T=e,F=$;break;case V:y=P.length/4;const r=new Uint16Array(y*4);for(let t=0;t<y;t++)A(P,t*4,r,t*4);T=r,F=V;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:H,height:I,data:T,header:D.string,gamma:D.gamma,exposure:D.exposure,type:F}}setDataType(g){return this.type=g,this}load(g,p,M,i){function B(c,E){switch(c.type){case $:case V:c.colorSpace=Z,c.minFilter=Y,c.magFilter=Y,c.generateMipmaps=!1,c.flipY=!0;break}p&&p(c,E)}return super.load(g,B,M,i)}}const ne=Object.freeze(Object.defineProperty({__proto__:null,RGBELoader:J},Symbol.toStringTag,{value:"Module"}));new J;const re=({url:d,className:g,onLoad:p,theme:M})=>{const i=w.useRef(null),B=w.useRef(null),c=w.useRef(null);return w.useEffect(()=>{let E,f,_,R,v=!0;return(async()=>{if(!i.current)return;const u=await z(()=>import("./three-vendor-DP-0WGkj.js").then(t=>t.aj),__vite__mapDeps([0,1])),{GLTFLoader:h}=await z(async()=>{const{GLTFLoader:t}=await import("./GLTFLoader-B5cqw9HA.js");return{GLTFLoader:t}},__vite__mapDeps([2,0,1])),{DRACOLoader:A}=await z(async()=>{const{DRACOLoader:t}=await import("./DRACOLoader-DtzSuKKZ.js");return{DRACOLoader:t}},__vite__mapDeps([3,0,1])),{RGBELoader:x}=await z(async()=>{const{RGBELoader:t}=await Promise.resolve().then(()=>ne);return{RGBELoader:t}},void 0);E=new u.Scene;const D=i.current.clientWidth/i.current.clientHeight;f=new u.PerspectiveCamera(45,D,.1,1e3),f.position.set(0,5,10),f.lookAt(0,0,0),_=new u.WebGLRenderer({antialias:!0,alpha:!0}),_.setPixelRatio(Math.min(window.devicePixelRatio,2)),_.setSize(i.current.clientWidth,i.current.clientHeight),_.toneMapping=u.ACESFilmicToneMapping,_.toneMappingExposure=1,_.outputColorSpace=u.SRGBColorSpace,i.current.appendChild(_.domElement),c.current=_;const H=new u.AmbientLight(16777215,.5);E.add(H);const I=new u.DirectionalLight(16777215,1);I.position.set(5,10,7),E.add(I),(async()=>{})();const T=new h,F=new A;F.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),T.setDRACOLoader(F),T.load(d,t=>{if(!v)return;const o=t.scene,s=new u.Box3().setFromObject(o),l=s.getCenter(new u.Vector3),n=s.getSize(new u.Vector3),a=5/Math.max(n.x,n.y,n.z);o.scale.setScalar(a),o.position.sub(l.multiplyScalar(a)),E.add(o),t.animations&&t.animations.length&&(R=new u.AnimationMixer(o),t.animations.forEach(G=>R.clipAction(G).play())),p&&p({_scene:E,_renderer:_})});const y=()=>{i.current&&(f.aspect=i.current.clientWidth/i.current.clientHeight,f.updateProjectionMatrix(),_.setSize(i.current.clientWidth,i.current.clientHeight))};window.addEventListener("resize",y);const e=new u.Clock,r=()=>{v&&(B.current=requestAnimationFrame(r),R&&R.update(e.getDelta()),E.children.length>0&&(E.rotation.y+=.001),_.render(E,f))};return r(),()=>{v=!1,window.removeEventListener("resize",y),cancelAnimationFrame(B.current),_&&_.dispose()}})(),()=>{}},[d,M]),j.jsx("div",{ref:i,className:g})},ae=w.forwardRef(({sceneId:d,className:g,onLoaded:p},M)=>{const[i,B]=w.useState(null),[c,E]=w.useState(!1),[f]=w.useState("dark"),_=w.useRef(null);w.useEffect(()=>{},[d]),w.useImperativeHandle(M,()=>({preload:X,load:R,attachScene:h=>{console.log(`[SplineCanvas] Attaching scene: ${h}`),R(h)},setTheme:h=>{setTheme(h)},updateEnvironment:v,dispose:()=>{}}));const R=async h=>{if(h){E(!0);try{const A=await te(h);if(!A){console.error(`[SplineCanvas] Scene ID "${h}" not found in manifest.`);return}B(A)}catch(A){console.error(`[SplineCanvas] Failed to load scene: ${h}`,A),p&&p()}finally{E(!1)}}},v=async h=>{_.current};w.useEffect(()=>{d&&(d==="hero"&&X("hero"),R(d))},[d]);const C=h=>{_.current=h,p&&p(h)},u=(i==null?void 0:i.endsWith(".glb"))||(i==null?void 0:i.endsWith(".gltf"));return j.jsx("div",{className:`relative w-full h-full ${g} transition-opacity duration-700 ${c?"opacity-0":"opacity-100"}`,children:i&&(u?j.jsx(re,{url:i,className:"w-full h-full",onLoad:C,theme:f}):j.jsx(ee,{scene:i,onLoad:h=>{C(h),p&&p(h)},className:"w-full h-full",renderOnDemand:!1}))})});ae.displayName="SplineCanvas";export{ae as S};
